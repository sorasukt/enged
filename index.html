<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ปิดปรับปรุงระบบชั่วคราว | System Maintenance</title>

    <!-- Google Fonts: IBM Plex Sans Thai -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Marked.js for Markdown Parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* CSS Variables & Reset */
        :root {
            --primary-red: #D32F2F;
            /* สีแดงหลัก */
            --light-red: #FFEBEE;
            /* สีแดงอ่อนสำหรับพื้นหลัง */
            --dark-red: #B71C1C;
            --white: #FFFFFF;
            --text-dark: #212121;
            --text-grey: #757575;
            --chat-bg: #F5F5F5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'IBM Plex Sans Thai', sans-serif;
            background-color: var(--white);
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            position: relative;
        }

        /* Decorative Background Elements */
        .bg-circle {
            position: absolute;
            border-radius: 50%;
            z-index: -1;
            opacity: 0.1;
        }

        .circle-1 {
            width: 300px;
            height: 300px;
            background-color: var(--primary-red);
            top: -50px;
            left: -50px;
        }

        .circle-2 {
            width: 200px;
            height: 200px;
            background-color: var(--primary-red);
            bottom: 50px;
            right: -50px;
        }

        /* Main Container */
        .container {
            max-width: 800px;
            padding: 2rem;
            width: 100%;
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            /* แก้ไข: จัดกึ่งกลางแนวนอนสำหรับ flex item */
        }

        /* Icon */
        .icon-container {
            margin-bottom: 1.5rem;
        }

        .icon-maintenance {
            width: 120px;
            height: 120px;
            fill: var(--primary-red);
            animation: pulse 2s infinite;
        }

        /* Typography */
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-red);
            margin-bottom: 0.5rem;
        }

        h2 {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--text-grey);
            margin-bottom: 2rem;
        }

        .schedule-box {
            background-color: var(--light-red);
            border: 1px solid var(--primary-red);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            /* แก้ไข: เปลี่ยนจาก inline-block เป็น block ธรรมดาเพื่อให้จัดการ layout ง่ายขึ้น */
            display: block;
            width: 100%;
            max-width: 600px;
            /* แก้ไข: ใช้ margin auto เพื่อความมั่นใจว่าจะอยู่ตรงกลางแน่นอน */
            margin-left: auto;
            margin-right: auto;
        }

        .schedule-time {
            font-size: 1.1rem;
            color: var(--text-dark);
            line-height: 1.6;
            font-weight: 500;
        }

        .schedule-time span {
            color: var(--primary-red);
            font-weight: 700;
            display: block;
            margin: 5px 0;
        }

        /* Countdown Timer */
        .countdown-container {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
        }

        .time-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
        }

        .time-value {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-red);
            line-height: 1;
        }

        .time-label {
            font-size: 0.9rem;
            color: var(--text-grey);
            margin-top: 5px;
        }

        /* Notification Box (Token Key) */
        .notice-card {
            background: var(--white);
            border-left: 5px solid var(--primary-red);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: left;
            max-width: 600px;
            width: 100%;
            /* เพิ่ม width 100% เพื่อความชัวร์ */
            margin: 0 auto 3rem auto;
        }

        .notice-title {
            font-weight: 700;
            color: var(--primary-red);
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 0.5rem;
        }

        .notice-text {
            color: var(--text-dark);
            font-size: 1rem;
        }

        /* --- AI Chat Widget Styling --- */
        .ai-chat-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-red);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 24px;
            font-family: 'IBM Plex Sans Thai', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s, background-color 0.2s;
            z-index: 1000;
        }

        .ai-chat-btn:hover {
            transform: translateY(-2px);
            background-color: var(--dark-red);
        }

        .chat-window {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 350px;
            height: 500px;
            background-color: var(--white);
            border-radius: 16px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
            display: none;
            /* Hidden by default */
            flex-direction: column;
            overflow: hidden;
            z-index: 1000;
            border: 1px solid #eee;
        }

        .chat-header {
            background-color: var(--primary-red);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .chat-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .chat-messages {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: var(--chat-bg);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 85%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 0.9rem;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .message.ai {
            background-color: var(--white);
            align-self: flex-start;
            border-bottom-left-radius: 2px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            color: var(--text-dark);
        }

        .message.user {
            background-color: var(--primary-red);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
            box-shadow: 0 1px 2px rgba(211, 47, 47, 0.2);
        }

        /* Markdown Content Styling within Messages */
        .message p {
            margin-bottom: 0.5em;
        }

        .message p:last-child {
            margin-bottom: 0;
        }

        .message ul,
        .message ol {
            margin-left: 1.2em;
            margin-bottom: 0.5em;
            padding-left: 0.5em;
        }

        .message li {
            margin-bottom: 0.2em;
        }

        .message strong {
            font-weight: 600;
        }

        /* Code styling inside bubbles */
        .message code {
            font-family: 'Courier New', Courier, monospace;
            background-color: rgba(0, 0, 0, 0.08);
            padding: 2px 4px;
            border-radius: 3px;
        }

        /* User message override to keep white text readable */
        .message.user code {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .loading-dots {
            display: inline-block;
            width: 30px;
            text-align: center;
        }

        .loading-dots:after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {

            0%,
            20% {
                content: '.';
            }

            40% {
                content: '..';
            }

            60% {
                content: '...';
            }

            80%,
            100% {
                content: '';
            }
        }

        .chat-input-area {
            padding: 15px;
            background-color: var(--white);
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            font-family: 'IBM Plex Sans Thai', sans-serif;
        }

        .chat-input:focus {
            border-color: var(--primary-red);
        }

        .chat-send-btn {
            background-color: var(--primary-red);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .chat-send-btn:hover {
            background-color: var(--dark-red);
        }

        .chat-send-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* Footer */
        footer {
            margin-top: auto;
            margin-bottom: 2rem;
            font-size: 0.85rem;
            color: #999;
        }

        /* Animations */
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }

            .countdown-container {
                gap: 1rem;
            }

            .time-value {
                font-size: 2rem;
            }

            .time-box {
                min-width: 60px;
            }

            .schedule-box {
                padding: 1rem;
            }

            .chat-window {
                width: 100%;
                height: 60vh;
                bottom: 0;
                right: 0;
                border-radius: 16px 16px 0 0;
            }

            .ai-chat-btn {
                bottom: 15px;
                right: 15px;
            }
        }
    </style>
</head>

<body>

    <!-- Decorative Circles -->
    <div class="bg-circle circle-1"></div>
    <div class="bg-circle circle-2"></div>

    <div class="container">
        <!-- Icon Section -->
        <div class="icon-container">
            <svg class="icon-maintenance" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z" />
            </svg>
        </div>

        <!-- Header -->
        <h1>ปิดปรับปรุงระบบชั่วคราว</h1>
        <h2>ขออภัยในความไม่สะดวก ขณะนี้เรากำลังพัฒนาระบบให้ดียิ่งขึ้น</h2>

        <!-- Time Schedule -->
        <div class="schedule-box">
            <p class="schedule-time">
                ระบบจะปิดให้บริการตั้งแต่
                <span>14 มกราคม 2569 เวลา 12:00 น.</span>
                ถึง
                <span>15 มกราคม 2569 เวลา 12:00 น.</span>
            </p>
        </div>

        <!-- Countdown Timer -->
        <p style="margin-bottom: 1rem; color: var(--text-grey);">ระบบจะเปิดใช้งานในอีก</p>
        <div class="countdown-container" id="countdown">
            <div class="time-box">
                <span class="time-value" id="days">00</span>
                <span class="time-label">วัน</span>
            </div>
            <div class="time-box">
                <span class="time-value" id="hours">00</span>
                <span class="time-label">ชั่วโมง</span>
            </div>
            <div class="time-box">
                <span class="time-value" id="minutes">00</span>
                <span class="time-label">นาที</span>
            </div>
            <div class="time-box">
                <span class="time-value" id="seconds">00</span>
                <span class="time-label">วินาที</span>
            </div>
        </div>

        <!-- Specific Message (Token Key) -->
        <div class="notice-card">
            <div class="notice-title">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                ข้อควรทราบ
            </div>
            <p class="notice-text">
                คุณจะสามารถค้นหารหัสกิจกรรมพร้อม <strong>Token Key</strong> ได้หลังเวลาปิดปรับปรุงระบบเสร็จสิ้น
            </p>
        </div>

        <footer>
            &copy; 2569 Your Company Name. All Rights Reserved.
        </footer>
    </div>

    <!-- AI Chat Widget -->
    <button class="ai-chat-btn" id="toggleChatBtn">
        <span>✨ สอบถาม AI</span>
    </button>

    <div class="chat-window" id="chatWindow">
        <div class="chat-header">
            <span>ผู้ช่วยระบบ (AI Support)</span>
            <button class="chat-close" id="closeChatBtn">✕</button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message ai">
                สวัสดีครับ! ผมเป็น AI ผู้ช่วยอัจฉริยะ ✨<br>
                มีข้อสงสัยเกี่ยวกับการปิดปรับปรุงระบบ หรืออยากให้ผมเล่าเรื่องตลกให้ฟังระหว่างรอไหมครับ?
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="userInput" placeholder="พิมพ์ข้อความ...">
            <button class="chat-send-btn" id="sendBtn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // Use DOMContentLoaded to ensure elements are ready before attaching listeners
        document.addEventListener('DOMContentLoaded', () => {

            // --- Countdown Timer Logic ---
            const countDownDate = new Date("Jan 15, 2026 12:00:00").getTime();
            const x = setInterval(function () {
                const now = new Date().getTime();
                const distance = countDownDate - now;

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                const daysEl = document.getElementById("days");
                if (daysEl) {
                    daysEl.innerHTML = days < 10 ? "0" + days : days;
                    document.getElementById("hours").innerHTML = hours < 10 ? "0" + hours : hours;
                    document.getElementById("minutes").innerHTML = minutes < 10 ? "0" + minutes : minutes;
                    document.getElementById("seconds").innerHTML = seconds < 10 ? "0" + seconds : seconds;
                }

                if (distance < 0) {
                    clearInterval(x);
                    const countdownEl = document.getElementById("countdown");
                    if (countdownEl) {
                        countdownEl.innerHTML = "<h2 style='color: var(--primary-red);'>ระบบเปิดให้บริการแล้ว</h2>";
                    }
                }
            }, 1000);

            // --- Attach Event Listeners ---
            document.getElementById('toggleChatBtn').addEventListener('click', toggleChat);
            document.getElementById('closeChatBtn').addEventListener('click', toggleChat);
            document.getElementById('sendBtn').addEventListener('click', sendMessage);
            document.getElementById('userInput').addEventListener('keypress', function (event) {
                if (event.key === 'Enter') {
                    sendMessage();
                }
            });
        });

        // --- Chat Widget Logic ---
        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            const currentDisplay = window.getComputedStyle(chatWindow).display;

            if (currentDisplay === 'none') {
                chatWindow.style.display = 'flex';
                document.getElementById('userInput').focus();
            } else {
                chatWindow.style.display = 'none';
            }
        }

        function addMessage(text, sender) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender);
            messageDiv.innerHTML = text; // Now contains HTML processed from Markdown for AI
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            const sendBtn = document.getElementById('sendBtn');

            if (!message) return;

            // Add user message (Simple text to avoid XSS from user input)
            // We use createTextNode or innerText safety manually if preferred, 
            // but for this simple context we keep innerHTML for potential emoji/basic consistency.
            // The prompt asked for AI Markdown support specifically.
            addMessage(message, 'user');

            input.value = '';
            input.disabled = true;
            sendBtn.disabled = true;

            // Add loading indicator
            const loadingId = 'loading-' + Date.now();
            const messagesDiv = document.getElementById('chatMessages');
            const loadingDiv = document.createElement('div');
            loadingDiv.classList.add('message', 'ai');
            loadingDiv.id = loadingId;
            loadingDiv.innerHTML = '<span class="loading-dots">กำลังคิด</span>';
            messagesDiv.appendChild(loadingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            try {
                const apiKey = ""; // API Key will be injected by the environment
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: message
                            }]
                        }],
                        systemInstruction: {
                            parts: [{
                                text: `คุณคือผู้ช่วย AI ประจำหน้าแจ้งปิดปรับปรุงระบบ (Maintenance Bot) ที่เป็นมิตรและช่วยเหลือได้ดี 
                                ข้อมูลสำคัญ:
                                1. ระบบปิดปรับปรุงตั้งแต่วันที่ 14 มกราคม 2569 เวลา 12:00 น. ถึง 15 มกราคม 2569 เวลา 12.00 น.
                                2. ผู้ใช้ต้องรอก่อนถึงจะค้นหา Token Key ได้ (หลังระบบเปิด)
                                3. ถ้าผู้ใช้ถามเรื่อง Token Key ให้บอกว่า "ใจเย็นๆ นะครับ รอระบบเปิดตอนเที่ยงพรุ่งนี้แล้วจะค้นหาได้แน่นอน"
                                4. ถ้าผู้ใช้เบื่อ ชวนคุยเรื่องตลก หรือเล่าเกร็ดความรู้สั้นๆ สนุกๆ ได้
                                5. ตอบเป็นภาษาไทยเสมอ
                                6. ใช้ Markdown ในการจัดรูปแบบคำตอบให้อ่านง่าย เช่น ตัวหนา (**text**) หรือ รายการ (- item) 
                                7. หากต้องการติดต่อเรื่องอื่น ๆ หรือติดต่อเจ้าหน้าที่ ให้ติดต่อที่เบอร์ 0633130922`
                            }]
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;

                // Remove loading
                const loadingEl = document.getElementById(loadingId);
                if (loadingEl) loadingEl.remove();

                // Parse Markdown to HTML
                const parsedResponse = marked.parse(aiResponse);
                addMessage(parsedResponse, 'ai');

            } catch (error) {
                console.error('Error:', error);
                const loadingEl = document.getElementById(loadingId);
                if (loadingEl) loadingEl.remove();
                addMessage('ขออภัยครับ ระบบ AI ขัดข้องชั่วคราว ลองใหม่อีกครั้งนะครับ', 'ai');
            } finally {
                input.disabled = false;
                sendBtn.disabled = false;
                input.focus();
            }
        }
    </script>
</body>

</html>